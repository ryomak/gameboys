# バスケットボールフリースローゲーム仕様書

## ゲーム概要
3Dグラフィックを使用したバスケットボールのフリースローシミュレーションゲーム。
プレイヤーはパワーと角度を調整してボールをゴールに投げ入れます。

## ゲームプレイ

### 基本ルール
1. プレイヤーは画面下部（フリースローライン）に立っている
2. Aボタンを押してパワーゲージを開始
3. もう一度Aボタンを押してパワーを決定
4. 上下キーで角度を微調整
5. Aボタンでシュート
6. ボールがゴールに入ったら得点

### 操作方法
- **十字キー上/下**: 角度調整
- **Aボタン**:
  - 1回目: パワーゲージ開始
  - 2回目: パワー決定
  - 3回目: シュート
- **Bボタン**: リセット/再挑戦
- **START**: ポーズ

## 画面レイアウト

### 3D視点
- カメラ: プレイヤーの後方やや上から見下ろす視点
- ゴール: 画面上部中央に配置（遠近感あり）
- ボール: スプライトのスケーリングで3D表現
- コート: 簡易的な背景（地面とゴール）

### UI要素
- **パワーゲージ**: 画面左下、縦バー形式
- **角度インジケーター**: 画面右下、弧を描くインジケーター
- **スコア**: 画面上部中央
- **試投数**: 画面上部右

## 物理演算

### ボールの軌道
放物線運動を固定小数点演算で計算：
```
x(t) = x0 + vx * t
y(t) = y0 + vy * t - (g * t^2) / 2
z(t) = z0 + vz * t
```

### パラメータ
- **重力**: g = 9.8 (固定小数点で表現)
- **初期位置**: (0, 2.0m, 0) フリースローライン
- **ゴール位置**: (0, 3.05m, 4.22m) 標準的なバスケゴール
- **ゴールサイズ**: 直径45cm

### 当たり判定
- ボールとゴールの距離を計算
- ゴールの半径以内 && Y座標がゴールの高さ付近 = 成功
- リムに当たった場合のバウンド処理（オプション）

## グラフィック仕様

### スプライト
1. **ボール**:
   - 基本サイズ: 16x16ピクセル
   - スケール範囲: 0.2x ~ 1.5x（距離に応じて）
   - 回転アニメーション

2. **ゴール（バスケットリム）**:
   - サイズ: 32x32ピクセル
   - 固定位置（画面上部）
   - 深度により若干スケール変化

3. **ネット**:
   - サイズ: 32x48ピクセル
   - ボールが入った時のアニメーション

4. **パワーゲージ**:
   - サイズ: 8x64ピクセル
   - 塗りつぶしで表現

### 背景
- Mode 0 (タイル背景)
- シンプルなコートの床
- 空と壁の表現

## ゲームステート

### 状態遷移
```
READY -> POWER_GAUGE -> ANGLE_ADJUST -> SHOOTING -> RESULT -> READY
```

1. **READY**: 初期状態、Aボタン待ち
2. **POWER_GAUGE**: パワーゲージが上下、Aボタンでパワー決定
3. **ANGLE_ADJUST**: 角度調整可能、Aボタンでシュート
4. **SHOOTING**: ボールが飛んでいる状態、物理演算実行
5. **RESULT**: 成功/失敗の表示
6. **READY**: 次の試投へ

## スコアリング

### 得点システム
- **成功**: +1点
- **連続成功ボーナス**: 3連続で+1点、5連続で+2点など
- **パーフェクトショット**: リムに触れずネットのみ = +2点

### 記録
- ベストスコア（10投中の成功数）
- 最高連続成功数
- パーフェクトショット数

## 技術実装の要点

### 3D表現
- スプライトのアフィン変換を使用
- Z座標に基づいてスケール計算: `scale = base_scale / (1 + z * depth_factor)`
- 深度ソートでスプライトの優先度を設定

### 固定小数点演算
- .8固定小数点を基本とする
- 物理演算の精度が必要な部分は.12を使用
- 三角関数はルックアップテーブルで実装

### メモリ管理
- スプライト数: 最大10個程度（ボール、ゴール、UI要素）
- VRAM使用量を最小化
- パレット: 256色モード

## 拡張要素（オプション）

### 難易度設定
- EASY: ゴールサイズ大、風なし
- NORMAL: 標準
- HARD: ゴールサイズ小、風あり

### 風の影響
- ランダムな風向きと強さ
- ボールの軌道に影響を与える

### 複数のコート
- 屋内コート
- 屋外コート（風あり）
- ストリートコート
